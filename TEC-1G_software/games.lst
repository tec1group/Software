0000                             ; TEC GAMES
0000                             ; ---------
0000                             ; 
0000                             ; These games can be used on the TEC with no add ons.  They are coded
0000                             ; to be used with MON3 and running at 4MHz
0000                             ; 
0000                             ;IO Port ASSIGNMENTS
0000                DSCAN:    EQU   0x01   ;DISPLAY CATHODE DRIVER LATCH
0000                DSEGMENT:   EQU   0x02   ;DISPLAY SEGMENT DRIVER LATCH
0000                API_BEEP:   EQU   0x03   ;Mon3 Beep
0000                API_A2SG:   EQU   0x04   ;Mon3 Convert A to 7Seg
0000                API_SCAN:   EQU   0x10   ;Mon3 Key Scanner
0000                API_MENU:   EQU   0x1F   ;Mon3 Menu Driver
0000                API_NOTE:   EQU   0x22   ;Mon3 Play Note
0000                API_TUNE:   EQU   0x23   ;Mon3 Play Tune
4000                          .ORG   4000H   
4000                GAMES:       
4000   ED 5F                  LD   A,R   
4002   32 4C 47               LD   (RANDNO),A   ;seed rng
4005   21 CB 46               LD   HL,gamesMenuCFG   
4008   0E 1F                  LD   C,API_MENU   ;menu driver
400A   D7                     RST   10H   ;mon3 API Call
400B   C9                     RET      
400C                             ; Segment Game by Jim Robinson
400C                             ; This game the player is to press any key when a moving target is in
400C                             ; the bottom segment on the 3rd LED segment from the right.  On each
400C                             ; hit the moving segment restarts and moves faster.
400C                             ; 
400C                             ;    A D D R E S S       D A T A
400C                             ;  --   --   --   --     --   --
400C                             ; |  | |  | |  | |  |   |  | |  |
400C                             ;  --   --   --   --     --   --
400C                             ; |  | |  | |  | |  |   |  | |  |
400C                             ;  --   --   --   --     --   --
400C                             ;                 ^^
400C                             ;                 ||
400C                             ;          This segment lit up
400C                SEGHIT:      
400C                SEGSCORE:   EQU   5000H   ;Score in HEX              (1-byte)
400C                SEGSPEED:   EQU   5001H   ;Speed variable            (1-byte)
400C   11 00 A0               LD   DE,0A000H   
400F   ED 53 01 50            LD   (SEGSPEED),DE   ;Initial Speed
4013   AF                     XOR   A   
4014   32 00 50               LD   (SEGSCORE),A   ;Initial Score is 0
4017                SH1:         
4017   21 B3 40               LD   HL,SEGDTBL   ;Segment table lookup
401A                SH2:         
401A   7E                     LD   A,(HL)   
401B   47                     LD   B,A   ;LED to Use
401C   23                     INC   HL   
401D   7E                     LD   A,(HL)   
401E   4F                     LD   C,A   ;Segment to Use
401F   23                     INC   HL   
4020   78                     LD   A,B   ;Check if last segment which is 0xFF
4021   FE FF                  CP   0FFH   ;Its game over if zero
4023   28 44                  JR   Z,SH6   
4025   D3 01                  OUT   (DSCAN),A   ;Light up LED and Segment
4027   79                     LD   A,C   
4028   D3 02                  OUT   (DSEGMENT),A   
402A   CD 36 40               CALL   SH3   ;Delay the movement
402D   CD 40 40               CALL   SH5   ;Check for key hit
4030   FE 12                  CP   12H   ;If segment is hit, KEYCHK returns 12H in A register
4032   28 E3                  JR   Z,SH1   ;Reset Segments and do it again
4034   18 E4                  JR   SH2   ;Display next Segment
4036                SH3:         
4036   ED 5B 01 50            LD   DE,(SEGSPEED)   
403A   1B           SH4:      DEC   DE   
403B   7A                     LD   A,D   
403C   B7                     OR   A   ;Check if 0
403D   C8                     RET   Z   ;Delay is done, exit
403E   18 FA                  JR   SH4   ;Keep decreasing to delay
4040                SH5:         
4040   C5                     PUSH   BC   
4041   D5                     PUSH   DE   
4042   0E 10                  LD   C,API_SCAN   ;key scan
4044   D7                     RST   10H   ;mon3 API Call
4045   D1                     POP   DE   
4046   C1                     POP   BC   
4047   C0                     RET   NZ   ;Return if no key hit
4048   78                     LD   A,B   ;Check if LED is on Third from RIGHT
4049   FE 04                  CP   04H   
404B   C0                     RET   NZ   ;Exit if not
404C   79                     LD   A,C   ;Check if Bottom Segment is LIT
404D   FE 80                  CP   80H   
404F   C0                     RET   NZ   ;Exit if not
4050   3A 00 50               LD   A,(SEGSCORE)   ;Update Score
4053   3C                     INC   A   
4054   27                     DAA      ;Adjust for BCD addition
4055   32 00 50               LD   (SEGSCORE),A   ;Save Score
4058   4F                     LD   C,A   ;Save for Scan
4059   CD 7C 40               CALL   SH7   ;Display Score
405C   ED 5B 01 50            LD   DE,(SEGSPEED)   ;Load Speed
4060   15                     DEC   D   ;Reduce Speed by 1
4061   15                     DEC   D   ;Reduce Speed by 1
4062   ED 53 01 50            LD   (SEGSPEED),DE   
4066   3E 12                  LD   A,12H   ;Tell main loop that segment was hit to reset segments
4068   C9                     RET      
4069                SH6:         
4069   11 00 FF               LD   DE,0FF00H   ;Some random address
406C   ED 53 01 50            LD   (SEGSPEED),DE   ;Set it to Speed (assume FF)
4070   3E BF                  LD   A,0BFH   
4072   D3 01                  OUT   (DSCAN),A   ;Light up all LEDS and speaker
4074   3E 85                  LD   A,85H   
4076   D3 02                  OUT   (DSEGMENT),A   ;Light up horizontal segments only
4078   CD 36 40               CALL   SH3   
407B   C9                     RET      ;Quit
407C   06 80        SH7:      LD   B,80H   ;Multiplex
407E   C5           SH8:      PUSH   BC   
407F   AF                     XOR   A   
4080   D3 02                  OUT   (DSEGMENT),A   
4082   3E 01                  LD   A,01H   
4084   D3 01                  OUT   (DSCAN),A   
4086   79                     LD   A,C   
4087   CD A8 40               CALL   SH11   
408A   06 00                  LD   B,00H   
408C   10 FE        SH9:      DJNZ   SH9   
408E   AF                     XOR   A   
408F   D3 02                  OUT   (DSEGMENT),A   
4091   3E 02                  LD   A,02H   
4093   D3 01                  OUT   (DSCAN),A   
4095   79                     LD   A,C   
4096   0F                     RRCA      
4097   0F                     RRCA      
4098   0F                     RRCA      
4099   0F                     RRCA      
409A   CD A8 40               CALL   SH11   
409D   06 00                  LD   B,00H   
409F   10 FE        SH10:     DJNZ   SH10   
40A1   AF                     XOR   A   
40A2   D3 01                  OUT   (DSCAN),A   
40A4   C1                     POP   BC   
40A5   10 D7                  DJNZ   SH8   
40A7   C9                     RET      
40A8                SH11:        
40A8   E6 0F                  AND   0FH   ;Mask high nibble
40AA   21 D4 40               LD   HL,SEGTBL   
40AD   85                     ADD   A,L   
40AE   6F                     LD   L,A   
40AF   7E                     LD   A,(HL)   ;Get Segment
40B0   D3 02                  OUT   (DSEGMENT),A   ;Display number
40B2   C9                     RET      
40B3                             ;Data for Segments, First Byte is LED to select (Port 1),
40B3                             ;and second byte is Segment to light up (Port 2)
40B3   20 01 10 01 08 01 04 01 SEGDTBL:   DB   20H,01H,10H,01H,08H,01H,04H,01H   
40BB   04 08 04 04 08 04 10 04 DB   04H,08H,04H,04H,08H,04H,10H,04H   
40C3   20 04 20 40 20 80 10 80 DB   20H,04H,20H,40H,20H,80H,10H,80H   
40CB   08 80 04 80 02 80 01 80 FF DB   08H,80H,04H,80H,02H,80H,01H,80H,0FFH   
40D4   EB 28 CD AD 2E A7 E7 29 EF 2F SEGTBL:   DB   0EBH,28H,0CDH,0ADH,2EH,0A7H,0E7H,29H,0EFH,2FH   
40DE                SIMON:       
40DE                             ;SIMON Game written by Jim Robertson
40DE                             ;-----------------------------------
40DE                             ; The 4 LED Segments from the right represent keys 0,4,8,C.
40DE                             ; The segments light up and the order they light up represents the
40DE                             ; keys to press.
40DE                             ; 
40DE                             ; Modified by B Chiha to auto populate random numbers at startup.
40DE                             ; 
40DE   CD B8 41               CALL   SMRAND   ;Set up random numbers from 5000 to 50FF
40E1   ED 5F                  LD   A,R   ;Get random number for random table lookup
40E3   6F                     LD   L,A   ;at 50xx
40E4                SM1:         
40E4   0E 01                  LD   C,01H   
40E6   CD 6C 41               CALL   SM12   
40E9   26 50                  LD   H,50H   
40EB                SM2:         
40EB   41                     LD   B,C   ;Working counter
40EC   E5                     PUSH   HL   
40ED                SM3:         
40ED   7E                     LD   A,(HL)   ;Get Random value
40EE   CD 80 41               CALL   SM15   
40F1   2C                     INC   L   
40F2   CD 6C 41               CALL   SM12   ;Call delay which shortens on each call
40F5   10 F6                  DJNZ   SM3   
40F7   E1                     POP   HL   
40F8   41                     LD   B,C   
40F9   E5                     PUSH   HL   
40FA                SM4:         
40FA   CD A8 41               CALL   SM18   
40FD   20 FB                  JR   NZ,SM4   ;No key pressed
40FF   FE 04                  CP   04H   ;Compare with 4 to see if valid key
4101   30 F7                  JR   NC,SM4   
4103   E5                     PUSH   HL   
4104   21 B4 41               LD   HL,SMTBL   ;Display Table
4107   85                     ADD   A,L   
4108   6F                     LD   L,A   
4109   7E                     LD   A,(HL)   ;Get display value based on key press
410A   E1                     POP   HL   
410B   BE                     CP   (HL)   ;Compare key pressed with value in lookup
410C   20 12                  JR   NZ,SM6   
410E   CD 80 41               CALL   SM15   
4111   2C                     INC   L   
4112                SM5:         
4112   CD A8 41               CALL   SM18   ;Get another key
4115   28 FB                  JR   Z,SM5   ;Loop until key released
4117   10 E1                  DJNZ   SM4   
4119   E1                     POP   HL   
411A   CD 6C 41               CALL   SM12   
411D   0C                     INC   C   
411E   18 CB                  JR   SM2   ;Jump back to start of game
4120                SM6:         
4120   3E 30                  LD   A,30H   ;Incorrect answer
4122   CD 80 41               CALL   SM15   
4125   41                     LD   B,C   
4126   AF                     XOR   A   
4127                SM7:         
4127   3C                     INC   A   
4128   27                     DAA      
4129   10 FC                  DJNZ   SM7   
412B   3D                     DEC   A   
412C   27                     DAA      
412D   4F                     LD   C,A   
412E   AF           SM8:      XOR   A   ;Multiplex
412F   D3 02                  OUT   (DSEGMENT),A   
4131   3E 04                  LD   A,04H   
4133   D3 01                  OUT   (DSCAN),A   
4135   79                     LD   A,C   
4136   CD 61 41               CALL   SM11   
4139   06 00                  LD   B,00H   
413B   10 FE        SM9:      DJNZ   SM9   
413D   AF                     XOR   A   
413E   D3 02                  OUT   (DSEGMENT),A   
4140   3E 08                  LD   A,08H   
4142   D3 01                  OUT   (DSCAN),A   
4144   79                     LD   A,C   
4145   0F                     RRCA      
4146   0F                     RRCA      
4147   0F                     RRCA      
4148   0F                     RRCA      
4149   CD 61 41               CALL   SM11   
414C   06 00                  LD   B,00H   
414E   10 FE        SM10:     DJNZ   SM10   
4150   CD A8 41               CALL   SM18   
4153   14                     INC   D   
4154   FE 12                  CP   12H   ;Check if GO pressed
4156   20 D6                  JR   NZ,SM8   ;Keep scanning until GO pressed
4158   6A                     LD   L,D   ;Put random number in L
4159   AF                     XOR   A   
415A   D3 01                  OUT   (DSCAN),A   
415C   CD 80 41               CALL   SM15   
415F   18 83                  JR   SM1   
4161                SM11:        
4161   E6 0F                  AND   0FH   ;Mask high nibble
4163   21 D4 40               LD   HL,SEGTBL   
4166   85                     ADD   A,L   
4167   6F                     LD   L,A   
4168   7E                     LD   A,(HL)   ;Get Segment
4169   D3 02                  OUT   (DSEGMENT),A   ;Display number
416B   C9                     RET      
416C                SM12:        
416C   11 00 80               LD   DE,8000H   
416F   79                     LD   A,C   ;Frame count
4170   07                     RLCA      
4171   07                     RLCA      
4172                SM13:        
4172   15                     DEC   D   
4173   3D                     DEC   A   
4174   20 FC                  JR   NZ,SM13   
4176                SM14:        
4176   1B                     DEC   DE   
4177   7A                     LD   A,D   
4178   B3                     OR   E   
4179   20 FB                  JR   NZ,SM14   
417B   3E 04                  LD   A,04H   
417D   D3 02                  OUT   (DSEGMENT),A   
417F   C9                     RET      
4180                SM15:        
4180   E5                     PUSH   HL   
4181   D5                     PUSH   DE   
4182   C5                     PUSH   BC   
4183   4F                     LD   C,A   
4184   07                     RLCA      
4185   C6 18                  ADD   A,18H   
4187   21 E0 06               LD   HL,06E0H   
418A   47                     LD   B,A   
418B   79                     LD   A,C   
418C   11 01 00               LD   DE,0001H   
418F   48                     LD   C,B   
4190   E6 0F                  AND   0FH   
4192                SM16:        
4192   D3 01                  OUT   (DSCAN),A   ;Display value
4194   41                     LD   B,C   
4195   10 FE        SM17:     DJNZ   SM17   
4197   EE 80                  XOR   80H   ;Toggle speaker bit
4199   ED 52                  SBC   HL,DE   
419B   20 F5                  JR   NZ,SM16   
419D   C1                     POP   BC   
419E   D1                     POP   DE   
419F   E1                     POP   HL   
41A0   3E 04                  LD   A,04H   ;G segment
41A2   D3 02                  OUT   (DSEGMENT),A   
41A4   AF                     XOR   A   
41A5   D3 01                  OUT   (DSCAN),A   
41A7   C9                     RET      
41A8                SM18:        
41A8   C5                     PUSH   BC   
41A9   D5                     PUSH   DE   
41AA   0E 10                  LD   C,API_SCAN   ;key scan
41AC   D7                     RST   10H   ;mon3 API Call
41AD   D1                     POP   DE   
41AE   C1                     POP   BC   
41AF   C0                     RET   NZ   ;No key pressed
41B0   5F                     LD   E,A   
41B1   AF                     XOR   A   ;Clear flags
41B2   7B                     LD   A,E   
41B3   C9                     RET      
41B4   08 04 02 01  SMTBL:    DB   08H,04H,02H,01H   
41B8                             ;Here is the random number generator that puts 1,2,4 and 8 in memory
41B8                             ;between 0B00 and 0BFF.  Call this routine first
41B8                SMRAND:      
41B8   06 00                  LD   B,00H   
41BA   21 00 50               LD   HL,5000H   
41BD   16 11                  LD   D,00010001B   ;(rotating 1 bits)
41BF                RG1:         
41BF   ED 5F                  LD   A,R   
41C1                RG2:         
41C1   CB 02                  RLC   D   
41C3   3D                     DEC   A   
41C4   20 FB                  JR   NZ,RG2   
41C6   7A                     LD   A,D   
41C7   E6 0F                  AND   0FH   
41C9   77                     LD   (HL),A   ;Store randome number
41CA   23                     INC   HL   
41CB   F5                     PUSH   AF   ;Waste time to move R on a bit
41CC   F1                     POP   AF   
41CD   10 F0                  DJNZ   RG1   
41CF   C9                     RET      
41D0                             ;Memory Locations
41D0                DOSCREEN:   EQU   5000H   ;Game Screen Data 6 Bytes
41D0                DOSCREND:   EQU   DOSCREEN+5   ;End of Screen
41D0                DODISTVL:   EQU   5006H   ;Distance Traveled 2 Bytes
41D0                DOPLAYPOS:   EQU   5008H   ;Player Position 1 Byte
41D0                DOKEYPRE:   EQU   5009H   ;Key press flag 1 Byte
41D0                DOSPEED:   EQU   500AH   ;Speed of update
41D0                             ;Constants
41D0                KEY_UP:   EQU   07H   ;Up Key Constant
41D0                KEY_DN:   EQU   03H   ;Down Key Constant
41D0                DODGY:       
41D0   06 0A                  LD   B,0AH   ;Do 10 times
41D2   21 00 50               LD   HL,DOSCREEN   ;Set HL to First RAM location
41D5   AF                     XOR   A   ;Zero A
41D6                DO1:         
41D6   77                     LD   (HL),A   ;Clear  Data
41D7   23                     INC   HL   
41D8   10 FC                  DJNZ   DO1   ;Repeat
41DA   0E 00                  LD   C,0   
41DC                DOGAME:      
41DC                             ;SHIFT TERRAIN
41DC   0D                     DEC   C   ;Decrease Delay and if
41DD   20 54                  JR   NZ,DO6   ;Zero shift terrain else just scan displays
41DF   06 05                  LD   B,05H   ;Shift down 5 times
41E1   DD 21 00 50            LD   IX,DOSCREEN   ;Point IX to Screen
41E5                DO2:         
41E5   DD 7E 01               LD   A,(IX+1)   ;Get value to the right
41E8   DD 77 00               LD   (IX+0),A   ;Place to the left
41EB   DD 23                  INC   IX   ;Move to next Segment
41ED   10 F6                  DJNZ   DO2   ;Repeat all five
41EF   DD 56 FB               LD   D,(IX-5)   ;Save first position for later
41F2                             ;ADD OBSTACLE ON SECOND SHIFT
41F2   3A 05 50               LD   A,(DOSCREND)   ;Get previous segment
41F5   B7                     OR   A   ;Is it Blank?
41F6   28 03                  JR   Z,DO3   ;Yes, Add Obstacle
41F8   AF                     XOR   A   ;Make it Blank
41F9   18 10                  JR   DO5   
41FB                DO3:         
41FB   CD 76 43               CALL   RANDOM   ;Get Random Value
41FE   2F                     CPL      ;Mix to make more random
41FF   E6 03                  AND   03H   ;Get the last two bits
4201   FE 03                  CP   03H   ;Is it Three?
4203   28 F6                  JR   Z,DO3   ;No, index is okay
4205                DO4:         
4205   21 94 42               LD   HL,OBSTACLES   ;Link HL to obstacle table
4208   85                     ADD   A,L   ;Get the index
4209   6F                     LD   L,A   ;Save the index
420A   7E                     LD   A,(HL)   ;Get Obstacle
420B                DO5:         
420B   32 05 50               LD   (DOSCREND),A   ;Add Obstacle/Blank
420E                             ;ADD PLAYER
420E   3A 08 50               LD   A,(DOPLAYPOS)   ;Get the player position
4211   21 97 42               LD   HL,DOPLAYER   ;Link HL to player table
4214   85                     ADD   A,L   ;Get the index
4215   6F                     LD   L,A   ;Save the index
4216   7E                     LD   A,(HL)   ;Get Player Segment
4217                             ;CHECK FOR COLLISION
4217   B2                     OR   D   ;Compare player verses obstacle
4218   BA                     CP   D   ;Is it the same as obstacle,
4219   28 54                  JR   Z,DO13   ;Yes, Its a Hit, Game Over
421B   32 00 50               LD   (DOSCREEN),A   ;Add Player to Screen.
421E                             ;UPDATE DISTANCE TRAVELED
421E   21 06 50               LD   HL,DODISTVL   ;Load HL with the TEN's of distance
4221   7E                     LD   A,(HL)   ;Get its value
4222   3C                     INC   A   ;Increase it by one
4223   27                     DAA      ;Convert to BCD
4224   77                     LD   (HL),A   ;Save it back
4225   23                     INC   HL   ;Load HL with the Hundreds's of dist
4226   3E 00                  LD   A,00H   ;Set A to zero (maintain carry)
4228   8E                     ADC   A,(HL)   ;Add Hundreds with Carry
4229   27                     DAA      ;Convert to BCD
422A   77                     LD   (HL),A   ;Save it back
422B   3A 0A 50               LD   A,(DOSPEED)   
422E   3D                     DEC   A   
422F   4F                     LD   C,A   
4230   32 0A 50               LD   (DOSPEED),A   
4233                             ;MULTIPLEX THE DISPLAY
4233                DO6:         
4233   CD 9A 42               CALL   DOSCAN   ;Display the screen
4236                             ;MOVE PLAYER
4236                             ;Replace RST 20/NOP to LD A,I if JMON isn't used
4236   C5                     PUSH   BC   
4237   D5                     PUSH   DE   
4238   0E 10                  LD   C,API_SCAN   ;key scan
423A   D7                     RST   10H   ;mon3 API Call
423B   D1                     POP   DE   
423C   C1                     POP   BC   
423D   47                     LD   B,A   
423E   28 06                  JR   Z,DO10   ;Continue with game
4240   AF                     XOR   A   ;Zero A
4241   32 09 50               LD   (DOKEYPRE),A   ;Save in key press as a no hit
4244                DO9:         
4244   18 96                  JR   DOGAME   ;Start Game loop
4246                DO10:        
4246   3A 09 50               LD   A,(DOKEYPRE)   ;Get key press flag
4249   B7                     OR   A   ;Is it zero
424A   20 F8                  JR   NZ,DO9   ;No, key needs to be released
424C   3D                     DEC   A   ;Set A to FF
424D   32 09 50               LD   (DOKEYPRE),A   ;Store in key press flag
4250   78                     LD   A,B   ;Restore Key Pressed
4251   FE 07                  CP   KEY_UP   ;Is key "UP"
4253   20 09                  JR   NZ,DO11   ;No, Check Down Key
4255   3A 08 50               LD   A,(DOPLAYPOS)   ;Get Player Position
4258   B7                     OR   A   ;Is it at the top already?
4259   28 E9                  JR   Z,DO9   ;Ignore Key hit
425B   3D                     DEC   A   ;Move down one
425C   18 0C                  JR   DO12   ;Save Move and continue with game
425E                DO11:        
425E   FE 03                  CP   KEY_DN   ;Is key "DN"
4260   20 E2                  JR   NZ,DO9   ;No, Continue with game
4262   3A 08 50               LD   A,(DOPLAYPOS)   ;Get Player Position
4265   FE 02                  CP   02H   ;Is it at the bottom already?
4267   28 DB                  JR   Z,DO9   ;Ignore Key hit
4269   3C                     INC   A   ;Move down one
426A                DO12:        
426A   32 08 50               LD   (DOPLAYPOS),A   ;Save new position
426D   18 D5                  JR   DO9   ;Continue with game
426F                             ;GAME OVER
426F                DO13:        
426F   2A 06 50               LD   HL,(DODISTVL)   ;Get Distanced Traveled
4272   CD B5 42               CALL   DOCON_HL   ;Convert to BCD and Display
4275                DO14:        
4275   0E 20                  LD   C,20H   ;Sound Routine
4277   69                     LD   L,C   
4278   AF                     XOR   A   
4279                FS3:         
4279   D3 01                  OUT   (DSCAN),A   
427B   41                     LD   B,C   
427C   10 FE        FS4:      DJNZ   FS4   
427E   EE 80                  XOR   80H   
4280   2D                     DEC   L   
4281   20 F6                  JR   NZ,FS3   
4283   CD 9A 42               CALL   DOSCAN   ;Display the screen
4286                             ;Replace RST 20/NOP to LD A,I if JMON isn't used
4286   C5                     PUSH   BC   
4287   D5                     PUSH   DE   
4288   0E 10                  LD   C,API_SCAN   ;key scan
428A   D7                     RST   10H   ;mon3 API Call
428B   D1                     POP   DE   
428C   C1                     POP   BC   
428D   FE 12                  CP   12H   ;GO Key
428F   20 E4                  JR   NZ,DO14   ;Not GO, repeat Scan
4291   C3 D0 41               JP   DODGY   
4294                OBSTACLES:      
4294   E4 0F 81               DB   0E4H,0FH,81H   ;Rock Low, Rock High and Gap
4297                DOPLAYER:      
4297   01 04 80               DB   01H,04H,80H   ;Dash High, Medium and Low
429A                DOSCAN:      
429A   06 20                  LD   B,20H   ;Segment Reference
429C   21 00 50               LD   HL,DOSCREEN   ;Set HL to Display Buffer
429F                DO7:         
429F   7E                     LD   A,(HL)   ;Get Segment Value at HL
42A0   D3 02                  OUT   (DSEGMENT),A   ;Set on Segment
42A2   78                     LD   A,B   ;Get Segment reference
42A3   D3 01                  OUT   (DSCAN),A   ;Activate segment
42A5   06 80                  LD   B,80H   ;Segment delay
42A7   10 FE        DO8:      DJNZ   DO8   
42A9   23                     INC   HL   ;Move to next location
42AA   47                     LD   B,A   ;Save Segment reference
42AB   AF                     XOR   A   ;Clear A
42AC   D3 01                  OUT   (DSCAN),A   ;Deactivate Segment
42AE   CB 08                  RRC   B   ;Move Segment Reference on to the Right
42B0   30 ED                  JR   NC,DO7   ;Scan next segment if more to do
42B2   D3 02                  OUT   (DSEGMENT),A   ;Clear port 2
42B4   C9                     RET      
42B5                             ;Convert HL and A to Seven Segment Display
42B5                DOCON_HL:      
42B5   01 00 50               LD   BC,DOSCREEN   ;Location of display buffer
42B8   7C                     LD   A,H   ;Get high byte of Address
42B9   CD BD 42               CALL   DOCON_A   ;Convert A to Segment Hex
42BC   7D                     LD   A,L   ;Get low byte of Address
42BD                DOCON_A:      
42BD   F5                     PUSH   AF   ;Save A to keep original value
42BE   07                     RLCA      ;Shift upper nibble to lower for masking
42BF   07                     RLCA      
42C0   07                     RLCA      
42C1   07                     RLCA      
42C2   CD C6 42               CALL   DOCON_NIBBLE   ;Convert Lower nibble to segment hex
42C5   F1                     POP   AF   ;Restore A
42C6                DOCON_NIBBLE:      
42C6   E6 0F                  AND   0FH   ;Only look at lower nibble for indexing
42C8   11 D4 40               LD   DE,SEGTBL   ;Reference Segment convert table
42CB   83                     ADD   A,E   ;Index table with A
42CC   5F                     LD   E,A   ;Update DE with index
42CD   1A                     LD   A,(DE)   ;Look up table
42CE   02                     LD   (BC),A   ;Save it to display buffer
42CF   03                     INC   BC   ;Increment buffer location
42D0   C9                     RET      
42D1                             ;SPIROID ALIEN REMAKE.
42D1                SPIALIEN:      
42D1                DELAYSP:   EQU   5000H   ;Game Delay Speed
42D1                MESGADR:   EQU   5002H   ;Message address
42D1                DISP_BUFF:   EQU   5004H   
42D1   01 00 0A               LD   BC,0A00H   ;Ten rounds / Zero hit
42D4                SPSTART:      
42D4   C5                     PUSH   BC   
42D5   3E F0                  LD   A,0F0H   
42D7   32 00 50               LD   (DELAYSP),A   ;Initial Delay speed
42DA                             ;Get Random Alien
42DA   CD 76 43               CALL   RANDOM   ;RNG
42DD   2F                     CPL      
42DE   E6 03                  AND   03H   ;Mask out last three bits
42E0                             ;Get Alien
42E0   57                     LD   D,A   ;Save Alien Key match
42E1   1E 01                  LD   E,01H   ;Scan Port
42E3   21 A0 43               LD   HL,ALIENS   ;Load HL with Alien Table
42E6   85                     ADD   A,L   ;Index HL with A
42E7   6F                     LD   L,A   
42E8   7E                     LD   A,(HL)   ;Get Alian Glyph
42E9                             ;Game Loop
42E9   D3 02                  OUT   (DSEGMENT),A   ;Send Glyph to Segments
42EB                SP2:         
42EB   7B                     LD   A,E   ;Get Scan Port
42EC   D3 01                  OUT   (DSCAN),A   ;Turn on Segment
42EE   CD 6A 43               CALL   DELAY   ;Pause for a bit
42F1   21 20 00               LD   HL,0020H   ;get delay
42F4   06 40                  LD   B,40H   ;wavylength
42F6   0E 22                  LD   C,API_NOTE   ;Note API
42F8   D7                     RST   10H   ;API CALL
42F9                             ;Check Key Hit
42F9   C5                     PUSH   BC   
42FA   D5                     PUSH   DE   
42FB   0E 10                  LD   C,API_SCAN   ;key scan
42FD   D7                     RST   10H   ;mon3 API Call
42FE   D1                     POP   DE   
42FF   C1                     POP   BC   
4300   20 03                  JR   NZ,SP3   ;No key Continue with game
4302   BA                     CP   D   ;Compare key with alien key
4303   28 0B                  JR   Z,SP4   ;Its a Hit,
4305                SP3:         
4305                             ;Move Segment
4305   CB 03                  RLC   E   ;Move Segment left one
4307   CB 73                  BIT   6,E   
4309   28 E0                  JR   Z,SP2   ;No, display again
430B                             ;Miss/Hit Setup
430B   21 B0 43               LD   HL,AMTABLE+6   ;Set to Miss Graphic
430E   18 03                  JR   SP5   ;Animate
4310                SP4:         
4310   21 AA 43               LD   HL,AHTABLE+6   ;Set To Hit Graphic
4313                SP5:         ;Animate Hit/Miss
4313   0E 01                  LD   C,01H   ;First Segment
4315                SP6:         
4315   3E FA                  LD   A,0FAH   ;Minus 6
4317   85                     ADD   A,L   ;Fix HL to point
4318   6F                     LD   L,A   ;To start of table
4319   06 06                  LD   B,06H   ;Six Segments
431B                SP7:         
431B   7E                     LD   A,(HL)   ;Get Segment
431C   D3 02                  OUT   (DSEGMENT),A   ;Light Segment
431E   79                     LD   A,C   ;Get Scan Bit
431F   D3 01                  OUT   (DSCAN),A   ;Turn on Segment
4321   E5                     PUSH   HL   ;Save HL
4322   C5                     PUSH   BC   ;Save BC
4323   CD 6A 43               CALL   DELAY   ;Wait
4326   21 00 50               LD   HL,DELAYSP   ;Get Delay Speed
4329   06 0E                  LD   B,0EH   ;Get Subtraction
432B   35           SP8:      DEC   (HL)   ;Take 14 off
432C   10 FD                  DJNZ   SP8   
432E   3A 00 50               LD   A,(DELAYSP)   
4331   6F                     LD   L,A   
4332   26 00                  LD   H,00H   ;Clear H
4334   41                     LD   B,C   
4335   0E 22                  LD   C,API_NOTE   
4337   D7                     RST   10H   ;     API CALL
4338   C1                     POP   BC   ;Restore
4339   E1                     POP   HL   ;Restore
433A   23                     INC   HL   ;Get next Segment
433B   10 DE                  DJNZ   SP7   ;Repeat until all segments printed
433D   CB 01                  RLC   C   ;Move to next segment
433F   0C                     INC   C   ;Increase C
4340   CB 59                  BIT   3,C   ;It it passed all segments
4342   28 D1                  JR   Z,SP6   ;Do next segment
4344   C1                     POP   BC   ;Restore Score/Rounds
4345   3E 80                  LD   A,80H   ;Check for hit/miss
4347   BE                     CP   (HL)   ;If 01H, then must be a hit
4348   20 01                  JR   NZ,SP9   ;Skip score update
434A   0C                     INC   C   ;Add to score
434B                SP9:         
434B   10 87                  DJNZ   SPSTART   ;Do next Round with new Alien
434D                GAMEOVER:      
434D   11 B0 43               LD   DE,WINTUNE   
4350   21 C4 43               LD   HL,WINMESG   
4353   79                     LD   A,C   ;Load # hits in A
4354   FE 07                  CP   07H   ;Has atleast 7 been hit?
4356   30 06                  JR   NC,SP11   
4358   11 BA 43               LD   DE,LOSTUNE   
435B   21 E2 43               LD   HL,LOSMESG   
435E                SP11:        
435E   22 02 50               LD   (MESGADR),HL   
4361   0E 23                  LD   C,API_TUNE   
4363   D7                     RST   10H   
4364   CD 85 43               CALL   ASCII_SCRL   
4367   C3 D1 42               JP   SPIALIEN   
436A                DELAY:       
436A   3A 00 50               LD   A,(DELAYSP)   
436D   67                     LD   H,A   
436E   2E 00                  LD   L,00H   
4370                SP10:        
4370   2B                     DEC   HL   
4371   7C                     LD   A,H   
4372   B5                     OR   L   
4373   20 FB                  JR   NZ,SP10   
4375   C9                     RET      
4376                RANDOM:      
4376   C5                     PUSH   BC   
4377   ED 5F                  LD   A,R   
4379   47                     LD   B,A   
437A   3A 4C 47               LD   A,(RANDNO)   
437D   A8                     XOR   B   
437E   87                     ADD   A,A   
437F   A8                     XOR   B   
4380   32 4C 47               LD   (RANDNO),A   
4383   C1                     POP   BC   
4384   C9                     RET      
4385                ASCII_SCRL:      
4385   2A 02 50               LD   HL,(MESGADR)   
4388   22 4A 47               LD   (ASCII_STR),HL   
438B                ASC0:        
438B   26 00                  LD   H,0   
438D                ASC1:        
438D   ED 5B 4A 47            LD   DE,(ASCII_STR)   
4391   E7                     RST   20H   
4392   C8                     RET   Z   
4393   25                     DEC   H   
4394   20 F7                  JR   NZ,ASC1   
4396   1A                     LD   A,(DE)   
4397   3C                     INC   A   
4398   28 EB                  JR   Z,ASCII_SCRL   
439A   21 4A 47               LD   HL,ASCII_STR   
439D   34                     INC   (HL)   
439E   18 EB                  JR   ASC0   
43A0   0F 26 61 C9  ALIENS:   DB   0FH,26H,61H,0C9H   
43A4   01 09 29 A9 E9 EB AHTABLE:   DB   01H,09H,29H,0A9H,0E9H,0EBH   ;Hit Animation
43AA   80 64 6B 64 80 00 AMTABLE:   DB   80H,64H,6BH,64H,80H,00H   ;Miss Animation
43B0   04 00 04 00 04 00 01 01 01 1F WINTUNE:   DB   04H,00H,04H,00H,04H,00H,01H,01H,01H,1FH   
43BA   01 18 01 18 01 18 01 18 01 1F LOSTUNE:   DB   01H,18H,01H,18H,01H,18H,01H,18H,01H,1FH   
43C4   00 00 00 00 00 00 6F C2 42 C7 WINMESG:   DB   00H,00H,00H,00H,00H,00H,6FH,0C2H,42H,0C7H   
43CE   6B A7 00 EC C7 A7 C6 4B EB DB   6BH,0A7H,00H,0ECH,0C7H,0A7H,0C6H,4BH,0EBH   
43D7   AE C7 EC 18 00 00 00 00 00 00 FF DB   0AEH,0C7H,0ECH,18H,00H,00H,00H,00H,00H,00H,0FFH   
43E2   00 00 00 00 00 00 C7 6B EC 00 LOSMESG:   DB   00H,00H,00H,00H,00H,00H,0C7H,6BH,0ECH,00H   
43EC   EB 47 00 C7 6F 4B C6 6E 18 00 DB   0EBH,47H,00H,0C7H,6FH,4BH,0C6H,6EH,18H,00H   
43F6   00 00 00 00 00         DB   00H,00H,00H,00H,00H   
43FB   FF FF                  DB   0FFH,0FFH   
43FD                             ;NIM Game -- John Hardie's Favourite Game!!
43FD                             ;Remove a match 1,2,3 and donâ€™t be the last.  This is a re-write, nothing wrong with the
43FD                             ;original, just wanted it to fit in to BMON.  Re-write by Brian Chiha
43FD                NIMMATCH:   EQU   5000H   ;Matches left
43FD                NIMPLAYER:   EQU   5001H   ;Current Player
43FD                NIM:         
43FD   3E 23                  LD   A,23H   ;Start with 23 Matches (BCD)
43FF   32 00 50               LD   (NIMMATCH),A   ;Save matches
4402   3E 55                  LD   A,01010101B   ;Player 1 starts, alternate 1/0 with rotate right
4404   32 01 50               LD   (NIMPLAYER),A   ;Save current player
4407   06 06                  LD   B,06H   ;Six Segments
4409   21 04 50               LD   HL,DISP_BUFF   ;Clear Screen
440C   AF                     XOR   A   ;Blank A
440D                NM1:         
440D   77                     LD   (HL),A   ;Blank Segment
440E   23                     INC   HL   
440F   10 FC                  DJNZ   NM1   ;Repeat for all six segments
4411                NM2:         
4411   21 01 50               LD   HL,NIMPLAYER   ;Get next player
4414   CB 0E                  RRC   (HL)   ;Rotate a check carry
4416   F5                     PUSH   AF   ;Save Flags
4417   CD 7F 44               CALL   NIMSCREEN   ;Fill Screen
441A   F1                     POP   AF   ;Restore Flags
441B   38 2A                  JR   C,NM5   ;Jump to player
441D   06 00                  LD   B,00H   ;Loop Screen
441F                NM3:         
441F   11 04 50               LD   DE,DISP_BUFF   
4422   C5                     PUSH   BC   
4423   E7                     RST   20H   ;Do Scan/Key Loop
4424   C1                     POP   BC   
4425   10 F8                  DJNZ   NM3   ;Loop screen
4427   3A 00 50               LD   A,(NIMMATCH)   ;Get Remaing matches
442A   FE 20                  CP   20H   ;Is it computers frist go?
442C   30 10                  JR   NC,NM4   ;Yes, get random pick
442E   FE 01                  CP   01H   ;Is 1 left?
4430   28 07                  JR   Z,NM31   ;do trick and lose
4432   FE 04                  CP   4   ;see if 3 or under
4434   30 03                  JR   NC,NM31   ;do trick
4436   3D                     DEC   A   
4437   18 1B                  JR   NM6   ;Update match and check win
4439                NM31:        
4439   3E 04                  LD   A,04H   ;4 - Players Pick always wins
443B   91                     SUB   C   ;Minus Players pick
443C   18 16                  JR   NM6   ;Update match and check win
443E                NM4:         
443E   CD 76 43               CALL   RANDOM   ;Simple Randomness
4441   CB C7                  SET   0,A   ;Ensure non zero
4443   E6 03                  AND   03H   ;Mask out high bits
4445   18 0D                  JR   NM6   ;Update match and check win
4447                NM5:         
4447   11 04 50               LD   DE,DISP_BUFF   
444A   E7                     RST   20H   ;Do Scan/Key Loop
444B   20 FA                  JR   NZ,NM5   ;No Key Press
444D   FE 04                  CP   04H   ;Is key greater than 3?
444F   30 F6                  JR   NC,NM5   ;Just loop scan
4451   B7                     OR   A   ;Is key 0?
4452   28 F3                  JR   Z,NM5   ;Just loop
4454                NM6:         
4454   4F                     LD   C,A   ;Save Match selection
4455   3A 00 50               LD   A,(NIMMATCH)   ;Get remaining matches
4458   B9                     CP   C   ;Are there enough matches?
4459   28 09                  JR   Z,NIMGAMEOVR   ;No, Game over
445B   38 07                  JR   C,NIMGAMEOVR   ;No, Game over
445D   91                     SUB   C   ;Subtract matches
445E   27                     DAA      ;Adjust for decimal
445F   32 00 50               LD   (NIMMATCH),A   ;Store it
4462   18 AD                  JR   NM2   ;Next Round
4464                NIMGAMEOVR:      
4464   0E 10                  LD   C,API_SCAN   ;key scan
4466   D7                     RST   10H   ;mon3 API Call
4467   28 FB                  JR   Z,NIMGAMEOVR   ;loop until key release
4469   3A 01 50               LD   A,(NIMPLAYER)   ;Get current Player
446C   CB 7F                  BIT   7,A   ;See who the current player is
446E   21 95 44               LD   HL,NIMWINNER   ;Load HL with Win Message
4471   28 03                  JR   Z,NM7   ;Player wins
4473   21 B3 44               LD   HL,NIMLOSER   ;Load HL with Lose Message
4476                NM7:         
4476   22 02 50               LD   (MESGADR),HL   
4479   CD 85 43               CALL   ASCII_SCRL   
447C   C3 FD 43               JP   NIM   ;Go back to start
447F                NIMSCREEN:      
447F   21 04 50               LD   HL,DISP_BUFF   ;Get Display buffer
4482   3E 4F                  LD   A,4FH   ;"P"
4484   38 02                  JR   C,NM8   ;Is player?
4486   3E C3                  LD   A,0C3H   ;"C"
4488                NM8:         
4488   77                     LD   (HL),A   ;Save C or P
4489   C5                     PUSH   BC   ;Save BC
448A   11 08 50               LD   DE,DISP_BUFF+4   ;Load DE with right most segments
448D   3A 00 50               LD   A,(NIMMATCH)   ;Load A with Matches Left
4490   0E 04                  LD   C,API_A2SG   ;Convert to 7Seg
4492   D7                     RST   10H   ;mon3 API Call
4493   C1                     POP   BC   ;Restore BC
4494   C9                     RET      
4495   00 00 00 00 00 00 EB 6E 00 6B NIMWINNER:   DB   00H,00H,00H,00H,00H,00H,0EBH,6EH,00H,6BH   
449F   EB 10 10 10 10 42 00 C2 EB A7 DB   0EBH,10H,10H,10H,10H,42H,00H,0C2H,0EBH,0A7H   
44A9   C6 18 18 00 00 00 00 00 00 FF DB   0C6H,18H,18H,00H,00H,00H,00H,00H,00H,0FFH   
44B3   00 00 00 00 00 00 AE EB EA 00 NIMLOSER:   DB   00H,00H,00H,00H,00H,00H,0AEH,0EBH,0EAH,00H   
44BD   C2 EB A7 C7 00 A7 C6 EA 4F DB   0C2H,0EBH,0A7H,0C7H,00H,0A7H,0C6H,0EAH,4FH   
44C6   42 EC 18 18 00 00 00 00 00 00 FF DB   42H,0ECH,18H,18H,00H,00H,00H,00H,00H,00H,0FFH   
44D1                             ;LUNALANDER
44D1                             ;you must land your luna module on the moon as gently as possible while
44D1                             ;gravity is pulling you down.  You can use the + key to fire your engine
44D1                             ;briefly this will slow down your descent but it also uses fuel.  If you
44D1                             ;run out of fuel you will crash
44D1                             ;Based off John Hardy's game on MON1.  Rewrite by Brian Chiha
44D1                LLALT:    EQU   5002H   ;Altitude
44D1                LLVEL:    EQU   5001H   ;Velocity
44D1                LLFUEL:   EQU   5000H   ;Fuel Left
44D1                PLUSKEY:   EQU   10H   ;Plus Key
44D1                LUNALANDER:      
44D1   3E 80                  LD   A,80H   ;Altitude at 50 meters (BCD)
44D3   32 02 50               LD   (LLALT),A   ;Save Starting Altitude
44D6   3E 15                  LD   A,15H   ;Starting Fuel (BCD)
44D8   32 00 50               LD   (LLFUEL),A   ;Save Fuel
44DB   AF                     XOR   A   ;Blank A
44DC   32 01 50               LD   (LLVEL),A   ;Starting Velocity of 0
44DF   06 06                  LD   B,06H   ;Six Segments
44E1   21 04 50               LD   HL,DISP_BUFF   ;Clear Screen
44E4                LL1:         
44E4   77                     LD   (HL),A   ;Blank Segment
44E5   23                     INC   HL   
44E6   10 FC                  DJNZ   LL1   ;Repeat for all six segments
44E8                LL2:         
44E8   CD 4D 45               CALL   LLSCREEN   ;Display the current lander stats
44EB   01 00 02               LD   BC,0200H   ;Drop counter
44EE                LL3:         ;Scan and Key Input
44EE   11 04 50               LD   DE,DISP_BUFF   
44F1   C5                     PUSH   BC   
44F2   E7                     RST   20H   ;Do Scan/Key Loop
44F3   C1                     POP   BC   
44F4   30 04                  JR   NC,LL33   ;Key held and not new
44F6   FE 10                  CP   PLUSKEY   ;Was Key Press Plus +?
44F8   28 07                  JR   Z,LL4   ;Yes Adjust Velocity
44FA                LL33:        
44FA   0B                     DEC   BC   ;Decrease delay
44FB   78                     LD   A,B   
44FC   B1                     OR   C   
44FD   20 EF                  JR   NZ,LL3   ;Not Zero so do Scan/Key again
44FF   18 14                  JR   LL5   ;Move Lander
4501                LL4:         ;Fuel Used
4501   3A 00 50               LD   A,(LLFUEL)   ;Check enough fuel
4504   B7                     OR   A   ;Is it zero?
4505   28 0E                  JR   Z,LL5   ;Yes, Move Lander
4507   3D                     DEC   A   ;Reduce Fuel
4508   27                     DAA      ;Decimal Adjust
4509   32 00 50               LD   (LLFUEL),A   ;Save fuel
450C   3A 01 50               LD   A,(LLVEL)   ;Load Velocity
450F   C6 02                  ADD   A,02H   ;Add 2 to Velocity
4511   27                     DAA      ;Decimal Adjust
4512   32 01 50               LD   (LLVEL),A   ;Save Velocity
4515                LL5:         ;Move Lander downwards
4515   3A 01 50               LD   A,(LLVEL)   ;Load Velocity
4518   D6 01                  SUB   01H   ;Reduce it by one
451A   27                     DAA      ;Decimal Adjust
451B   32 01 50               LD   (LLVEL),A   ;Save Veloicty
451E   47                     LD   B,A   ;Save B with Velocity
451F   3A 02 50               LD   A,(LLALT)   ;Get Altitude
4522   80                     ADD   A,B   ;Add Veloicity to Altitude
4523   27                     DAA      ;Decimal Adjust
4524   32 02 50               LD   (LLALT),A   ;Save Altitude
4527   B7                     OR   A   ;Have we landed?
4528   F2 E8 44               JP   P,LL2   ;Not Yet, Next Round
452B   78                     LD   A,B   ;Check Velocity
452C   C6 02                  ADD   A,02H   ;Add 2
452E   27                     DAA      ;Adjust for decimal
452F   B7                     OR   A   ;Check if 0 or over
4530   F2 3B 45               JP   P,LL6   ;Yes, Winner!
4533   21 A8 45               LD   HL,LUNALOSER   ;Load HL with LOSE Message
4536   11 7E 45               LD   DE,LUNALOSE   ;Load DE with LOSE Tune
4539   18 06                  JR   LL7   
453B                LL6:         
453B   21 87 45               LD   HL,LUNAWINNER   ;Load HL with WIN Message
453E   11 75 45               LD   DE,LUNAWIN   ;Load DE with WIN Tune
4541                LL7:         
4541   22 02 50               LD   (MESGADR),HL   
4544   0E 23                  LD   C,API_TUNE   
4546   D7                     RST   10H   
4547   CD 85 43               CALL   ASCII_SCRL   
454A   C3 D1 44               JP   LUNALANDER   
454D                LLSCREEN:      
454D   11 04 50               LD   DE,DISP_BUFF   ;Get Display buffer
4550   3A 00 50               LD   A,(LLFUEL)   ;Get Fuel
4553   0E 04                  LD   C,API_A2SG   ;Convert to 7Seg
4555   D7                     RST   10H   ;mon3 API Call
4556   11 06 50               LD   DE,DISP_BUFF+2   
4559   3A 02 50               LD   A,(LLALT)   ;Get Altitude
455C   47                     LD   B,A   ;Save
455D   0E 80                  LD   C,80H   ;Bottom Segment
455F   FE 15                  CP   15H   ;It is under 10
4561   38 08                  JR   C,LLS1   ;Yes
4563   0E 04                  LD   C,04H   ;Middle Segments
4565   FE 40                  CP   40H   ;It is half way
4567   38 02                  JR   C,LLS1   ;Yes
4569   0E 01                  LD   C,01H   ;Top Segments
456B                LLS1:        
456B   79                     LD   A,C   ;Get Segments
456C   12                     LD   (DE),A   ;Write it
456D   13                     INC   DE   ;Move to next segment
456E   12                     LD   (DE),A   ;Write it
456F   13                     INC   DE   ;Move to last two segments
4570   78                     LD   A,B   ;Restore Altituded
4571   0E 04                  LD   C,API_A2SG   ;Convert to 7Seg
4573   D7                     RST   10H   ;mon3 API Call
4574   C9                     RET      
4575   14 12 14 17 17 12 14 10 1F LUNAWIN:   DB   14H,12H,14H,17H,17H,12H,14H,10H,1FH   
457E   01 11 01 11 01 11 01 11 1F LUNALOSE:   DB   01H,11H,01H,11H,01H,11H,01H,11H,1FH   
4587   00 00 00 00 00 00 E3 4B C7 LUNAWINNER:   DB   00H,00H,00H,00H,00H,00H,0E3H,4BH,0C7H   
4590   6F C6 00 C2 6F 6B EC 42 6B DB   6FH,0C6H,00H,0C2H,6FH,6BH,0ECH,42H,6BH   
4599   E3 00 E8 EB 6E 6B 18 18 00 DB   0E3H,00H,0E8H,0EBH,6EH,6BH,18H,18H,00H   
45A2   00 00 00 00 00 FF      DB   00H,00H,00H,00H,00H,0FFH   
45A8   00 00 00 00 00 00 6F 6F 6F 4B LUNALOSER:   DB   00H,00H,00H,00H,00H,00H,6FH,6FH,6FH,4BH   
45B2   E3 18 18 00 AE EB EA 00 EC DB   0E3H,18H,18H,00H,0AEH,0EBH,0EAH,00H,0ECH   
45BB   42 C7 18 18 00 00 00 00 00 00 FF DB   42H,0C7H,18H,18H,00H,00H,00H,00H,00H,00H,0FFH   
45C6                MMGUESS:   EQU   5000H   ;Guess Made by user (4 bytes)
45C6                MMANSWER:   EQU   5004H   ;Answer (4 bytes)
45C6                MM_BUFF:   EQU   5008H   ;Display Buffer
45C6                MMSCORE:   EQU   500EH   ;Correct/Score
45C6                MASTERMIND:      
45C6   21 08 50               LD   HL,MM_BUFF   ;Load HL with Display
45C9   AF                     XOR   A   
45CA   06 04                  LD   B,04H   ;four Segments
45CC                MM00:        
45CC   77                     LD   (HL),A   ;Blank Segment
45CD   23                     INC   HL   
45CE   10 FC                  DJNZ   MM00   ;Repeat for all six segments
45D0   06 20                  LD   B,20H   
45D2                MM0:         
45D2   11 08 50               LD   DE,MM_BUFF   ;Load HL with Display
45D5   C5                     PUSH   BC   
45D6   E7                     RST   20H   ;Do Scan/Key Loop
45D7   C1                     POP   BC   
45D8   38 11                  JR   C,MM2   ;Key Press Exit
45DA   10 F6                  DJNZ   MM0   
45DC   06 02                  LD   B,02H   ;Loop for two segments
45DE   21 0C 50               LD   HL,MM_BUFF+4   
45E1                MM1:         
45E1   CD 76 43               CALL   RANDOM   ;Get Random Number
45E4   27                     DAA      ;Convert to 0-9
45E5   77                     LD   (HL),A   ;Fill Screen
45E6   23                     INC   HL   
45E7   10 F8                  DJNZ   MM1   ;Do for second byte
45E9   18 DB                  JR   MASTERMIND   ;Keep going until key press
45EB                MM2:         
45EB   21 0C 50               LD   HL,MM_BUFF+4   
45EE   11 04 50               LD   DE,MMANSWER   ;Load HL with Answer Location
45F1   0E 02                  LD   C,02H   ;Two Bytes
45F3                MM3:         
45F3   06 02                  LD   B,02H   ;Do Twice
45F5                MM4:         
45F5   AF                     XOR   A   ;Clear A
45F6   ED 6F                  RLD      ;Get High Nibble in A
45F8   12                     LD   (DE),A   ;Load BC with A
45F9   13                     INC   DE   ;Move to next location
45FA   10 F9                  DJNZ   MM4   ;Do for second nibble
45FC   23                     INC   HL   
45FD   0D                     DEC   C   ;Second Byte
45FE   20 F3                  JR   NZ,MM3   ;Do Again
4600                             ;Game Starts
4600                MM5:         
4600   AF                     XOR   A   
4601   32 0E 50               LD   (MMSCORE),A   
4604   21 08 50               LD   HL,MM_BUFF   ;Get Display buffer
4607   06 04                  LD   B,04H   ;Clear first four segments
4609   AF                     XOR   A   ;Clear A
460A                MM6:         
460A   77                     LD   (HL),A   ;Fill with Blank
460B   23                     INC   HL   ;Move to next segment
460C   10 FC                  DJNZ   MM6   ;Again
460E   3E 04                  LD   A,04H   ;Middle Segment
4610   77                     LD   (HL),A   ;Display Segment
4611   23                     INC   HL   ;Move to last segment
4612   77                     LD   (HL),A   ;Display Segment
4613   21 00 50               LD   HL,MMGUESS   ;Load Guess
4616   DD 21 08 50            LD   IX,MM_BUFF   
461A                             ;Players Move
461A                MM7:         
461A   11 08 50               LD   DE,MM_BUFF   ;Link BC to Display for A2CODE to work
461D   E7                     RST   20H   ;Do Scan/Key Loop
461E   30 FA                  JR   NC,MM7   ;No Key Press Exit, Keep Scaning
4620   FE 0A                  CP   0AH   ;Is it greater than A?
4622   30 F6                  JR   NC,MM7   ;Invalid Key, Keep Scaning
4624   77                     LD   (HL),A   ;Save player number
4625   01 D4 40               LD   BC,SEGTBL   ;Load Segment Table
4628   81                     ADD   A,C   ;Index Table
4629   4F                     LD   C,A   ; 
462A   0A                     LD   A,(BC)   ;Get Segment
462B   DD 77 00               LD   (IX),A   ;Save number to screen
462E   23                     INC   HL   ;Move to next guess number
462F   DD 23                  INC   IX   
4631   CB 55                  BIT   2,L   ;Is HL 5004?
4633   28 E5                  JR   Z,MM7   ;Get Next Key
4635                             ;Compare Guess to Answer
4635                MM8:         
4635   CD 92 46               CALL   THINKING   ;Display Thinking Animation
4638   21 04 50               LD   HL,MMANSWER   ;Link HL To Answer
463B   11 00 50               LD   DE,MMGUESS   ;Link DE to Guess
463E   06 04                  LD   B,04H   ;Tries
4640                MM9:         
4640   1A                     LD   A,(DE)   ;Get Guess
4641   BE                     CP   (HL)   ;Does it Match?
4642   20 08                  JR   NZ,MM10   ;No
4644   3A 0E 50               LD   A,(MMSCORE)   ;Get Score
4647   C6 10                  ADD   A,10H   ;Yes, Add one to upper nibble
4649   32 0E 50               LD   (MMSCORE),A   ;Save Score
464C                MM10:        
464C   C5                     PUSH   BC   ;Save BC
464D   06 03                  LD   B,03   ;Check other three guesses
464F                MM11:        
464F   13                     INC   DE   ;Move to next guess
4650   7B                     LD   A,E   ;Mask E to for overflow
4651   E6 03                  AND   03H   ;Loop if > 3
4653   5F                     LD   E,A   ;Reset E
4654   1A                     LD   A,(DE)   ;Get Guess
4655   BE                     CP   (HL)   ;Does it Match?
4656   20 07                  JR   NZ,MM12   ;No
4658   3A 0E 50               LD   A,(MMSCORE)   ;Get Score
465B   3C                     INC   A   ;Yes, Add one to upper nibble
465C   32 0E 50               LD   (MMSCORE),A   ;Save Score
465F                MM12:        
465F   10 EE                  DJNZ   MM11   ;Do 3 times
4661   C1                     POP   BC   ;Restore BC
4662   23                     INC   HL   ;Next Answer
4663   7D                     LD   A,L   ;Make E = L-4
4664   D6 04                  SUB   04H   ;Subtract 4
4666   5F                     LD   E,A   ;Reset E
4667   10 D7                  DJNZ   MM9   ;Do for all 4 numbers
4669                             ;Display Score
4669   C5                     PUSH   BC   ;Save BC
466A   11 0C 50               LD   DE,MM_BUFF+4   ;Load DE with right most segments
466D   3A 0E 50               LD   A,(MMSCORE)   ;Get Score
4670   0E 04                  LD   C,API_A2SG   ;Convert to 7Seg
4672   D7                     RST   10H   ;mon3 API Call
4673   C1                     POP   BC   ;Restore BC
4674   3A 0E 50               LD   A,(MMSCORE)   ;Get Score
4677   CB 77                  BIT   6,A   ;Winner?
4679   28 06                  JR   Z,MM13   
467B   11 B0 43               LD   DE,WINTUNE   
467E   0E 23                  LD   C,API_TUNE   
4680   D7                     RST   10H   
4681                MM13:        
4681   11 08 50               LD   DE,MM_BUFF   ;Load DE with segments
4684   E7                     RST   20H   ;Do Scan/Key Loop
4685   20 FA                  JR   NZ,MM13   ;Repeat until key pressed
4687   3A 0E 50               LD   A,(MMSCORE)   ;Get Score
468A   CB 77                  BIT   6,A   ;Winner?
468C   C2 C6 45               JP   NZ,MASTERMIND   ;Start New Game
468F   C3 00 46               JP   MM5   ;Start Next Round Again
4692                             ;Thinking Animation
4692                THINKING:      
4692   06 02                  LD   B,02H   ;Full loop, 4 Times
4694   21 0C 50               LD   HL,MM_BUFF+4   ;Get Display buffer last two segments
4697                THK1:        
4697   11 BB 46               LD   DE,THINKTBL   ;Link to Thinking Table
469A   C5                     PUSH   BC   ;Save BC
469B   06 08                  LD   B,08H   ;Eight loops
469D                THK2:        
469D   1A                     LD   A,(DE)   ;Get Move
469E   77                     LD   (HL),A   ;Display Move
469F   23                     INC   HL   ;Next Display
46A0   13                     INC   DE   ;Next Segment
46A1   1A                     LD   A,(DE)   ;Get Move
46A2   77                     LD   (HL),A   ;Display Move
46A3   13                     INC   DE   ;Next Segment
46A4   C5                     PUSH   BC   ;Save B
46A5   06 30                  LD   B,30H   ;Delay
46A7                THK3:        
46A7   D5                     PUSH   DE   
46A8   11 08 50               LD   DE,MM_BUFF   ;Get Display buffer last two segments
46AB   E5                     PUSH   HL   
46AC   C5                     PUSH   BC   
46AD   E7                     RST   20H   ;Do Scan/Key Loop
46AE   C1                     POP   BC   
46AF   E1                     POP   HL   
46B0   D1                     POP   DE   
46B1   10 F4                  DJNZ   THK3   ;Scan Again
46B3   2B                     DEC   HL   ;Restore HL
46B4   C1                     POP   BC   ;Restore BC
46B5   10 E6                  DJNZ   THK2   ;Do next Segment
46B7   C1                     POP   BC   ;Get C
46B8   10 DD                  DJNZ   THK1   ;Repeat Sequence
46BA   C9                     RET      
46BB   04 04 02 08 01 01 08 02 THINKTBL:   DB   04H,04H,02H,08H,01H,01H,08H,02H   
46C3   04 04 40 20 80 80 20 40 DB   04H,04H,40H,20H,80H,80H,20H,40H   
46CB                             ;Menu Command String
46CB                GAMESMENUCFG:      
46CB   07                     DB   7   
46CC   47 61 6D 65 73 20      DB   "Games "   ;7segment Text
46D2                             ;"                   " <- Max LCD entry width
46D2   20 54 45 43 20 53 65 67 6D 65 6E 74 20 47 61 6D 65 73 20 00 DB   " TEC Segment Games ",0   
46E6   53 65 67 6D 65 6E 74 20 48 69 74 00 DB   "Segment Hit",0   
46F2   0C 40                  DW   SEGHIT   
46F4   53 69 6D 70 6C 65 20 53 69 6D 6F 6E 00 DB   "Simple Simon",0   
4701   DE 40                  DW   SIMON   
4703   44 6F 64 67 79 00      DB   "Dodgy",0   
4709   D0 41                  DW   DODGY   
470B   53 70 69 72 6F 69 64 20 41 6C 69 65 6E 00 DB   "Spiroid Alien",0   
4719   D1 42                  DW   SPIALIEN   
471B   4E 49 4D 20 4D 61 74 63 68 65 73 20 47 61 6D 65 00 DB   "NIM Matches Game",0   
472C   FD 43                  DW   NIM   
472E   4C 75 6E 61 72 20 4C 61 6E 64 65 72 00 DB   "Lunar Lander",0   
473B   D1 44                  DW   LUNALANDER   
473D   4D 61 73 74 65 72 6D 69 6E 64 00 DB   "Mastermind",0   
4748   C6 45                  DW   MASTERMIND   
474A                ASCII_STR:      
474A   00 00                  DS   2,0   
474C                RANDNO:      
474C   00                     DS   1,0   


DSCAN:              0001 DEFINED AT LINE 8
                    > USED AT LINE 62
                    > USED AT LINE 109
                    > USED AT LINE 119
                    > USED AT LINE 127
                    > USED AT LINE 137
                    > USED AT LINE 224
                    > USED AT LINE 232
                    > USED AT LINE 247
                    > USED AT LINE 289
                    > USED AT LINE 301
                    > USED AT LINE 469
                    > USED AT LINE 500
                    > USED AT LINE 506
                    > USED AT LINE 565
                    > USED AT LINE 602
DSEGMENT:           0002 DEFINED AT LINE 9
                    > USED AT LINE 64
                    > USED AT LINE 111
                    > USED AT LINE 117
                    > USED AT LINE 125
                    > USED AT LINE 147
                    > USED AT LINE 222
                    > USED AT LINE 230
                    > USED AT LINE 256
                    > USED AT LINE 273
                    > USED AT LINE 299
                    > USED AT LINE 498
                    > USED AT LINE 509
                    > USED AT LINE 562
                    > USED AT LINE 600
API_BEEP:           0003 DEFINED AT LINE 10
API_A2SG:           0004 DEFINED AT LINE 11
                    > USED AT LINE 791
                    > USED AT LINE 887
                    > USED AT LINE 906
                    > USED AT LINE 1037
API_SCAN:           0010 DEFINED AT LINE 12
                    > USED AT LINE 80
                    > USED AT LINE 306
                    > USED AT LINE 425
                    > USED AT LINE 480
                    > USED AT LINE 574
                    > USED AT LINE 769
API_MENU:           001F DEFINED AT LINE 13
                    > USED AT LINE 22
API_NOTE:           0022 DEFINED AT LINE 14
                    > USED AT LINE 569
                    > USED AT LINE 614
API_TUNE:           0023 DEFINED AT LINE 15
                    > USED AT LINE 641
                    > USED AT LINE 880
                    > USED AT LINE 1044
GAMES:              4000 DEFINED AT LINE 18
SEGHIT:             400C DEFINED AT LINE 41
                    > USED AT LINE 1099
SEGSCORE:           5000 DEFINED AT LINE 43
                    > USED AT LINE 49
                    > USED AT LINE 92
                    > USED AT LINE 95
SEGSPEED:           5001 DEFINED AT LINE 44
                    > USED AT LINE 47
                    > USED AT LINE 71
                    > USED AT LINE 99
                    > USED AT LINE 102
                    > USED AT LINE 107
SH1:                4017 DEFINED AT LINE 50
                    > USED AT LINE 68
SH2:                401A DEFINED AT LINE 52
                    > USED AT LINE 69
SH3:                4036 DEFINED AT LINE 70
                    > USED AT LINE 65
                    > USED AT LINE 112
SH4:                403A DEFINED AT LINE 72
                    > USED AT LINE 76
SH5:                4040 DEFINED AT LINE 77
                    > USED AT LINE 66
SH6:                4069 DEFINED AT LINE 105
                    > USED AT LINE 61
SH7:                407C DEFINED AT LINE 114
                    > USED AT LINE 98
SH8:                407E DEFINED AT LINE 115
                    > USED AT LINE 139
SH9:                408C DEFINED AT LINE 123
                    > USED AT LINE 123
SH10:               409F DEFINED AT LINE 135
                    > USED AT LINE 135
SH11:               40A8 DEFINED AT LINE 141
                    > USED AT LINE 121
                    > USED AT LINE 133
SEGDTBL:            40B3 DEFINED AT LINE 152
                    > USED AT LINE 51
SEGTBL:             40D4 DEFINED AT LINE 156
                    > USED AT LINE 143
                    > USED AT LINE 252
                    > USED AT LINE 529
                    > USED AT LINE 989
SIMON:              40DE DEFINED AT LINE 158
                    > USED AT LINE 1101
SM1:                40E4 DEFINED AT LINE 170
                    > USED AT LINE 249
SM2:                40EB DEFINED AT LINE 174
                    > USED AT LINE 208
SM3:                40ED DEFINED AT LINE 177
                    > USED AT LINE 182
SM4:                40FA DEFINED AT LINE 186
                    > USED AT LINE 188
                    > USED AT LINE 190
                    > USED AT LINE 204
SM5:                4112 DEFINED AT LINE 201
                    > USED AT LINE 203
SM6:                4120 DEFINED AT LINE 209
                    > USED AT LINE 198
SM7:                4127 DEFINED AT LINE 214
                    > USED AT LINE 217
SM8:                412E DEFINED AT LINE 221
                    > USED AT LINE 244
SM9:                413B DEFINED AT LINE 228
                    > USED AT LINE 228
SM10:               414E DEFINED AT LINE 240
                    > USED AT LINE 240
SM11:               4161 DEFINED AT LINE 250
                    > USED AT LINE 226
                    > USED AT LINE 238
SM12:               416C DEFINED AT LINE 258
                    > USED AT LINE 172
                    > USED AT LINE 181
                    > USED AT LINE 206
SM13:               4172 DEFINED AT LINE 263
                    > USED AT LINE 266
SM14:               4176 DEFINED AT LINE 267
                    > USED AT LINE 271
SM15:               4180 DEFINED AT LINE 275
                    > USED AT LINE 179
                    > USED AT LINE 199
                    > USED AT LINE 211
                    > USED AT LINE 248
SM16:               4192 DEFINED AT LINE 288
                    > USED AT LINE 294
SM17:               4195 DEFINED AT LINE 291
                    > USED AT LINE 291
SM18:               41A8 DEFINED AT LINE 303
                    > USED AT LINE 187
                    > USED AT LINE 202
                    > USED AT LINE 241
SMTBL:              41B4 DEFINED AT LINE 316
                    > USED AT LINE 192
SMRAND:             41B8 DEFINED AT LINE 320
                    > USED AT LINE 167
RG1:                41BF DEFINED AT LINE 324
                    > USED AT LINE 336
RG2:                41C1 DEFINED AT LINE 326
                    > USED AT LINE 329
DOSCREEN:           5000 DEFINED AT LINE 340
                    > USED AT LINE 341
                    > USED AT LINE 352
                    > USED AT LINE 364
                    > USED AT LINE 400
                    > USED AT LINE 495
                    > USED AT LINE 514
DOSCREND:           5005 DEFINED AT LINE 341
                    > USED AT LINE 372
                    > USED AT LINE 389
DODISTVL:           5006 DEFINED AT LINE 342
                    > USED AT LINE 402
                    > USED AT LINE 462
DOPLAYPOS:          5008 DEFINED AT LINE 343
                    > USED AT LINE 391
                    > USED AT LINE 444
                    > USED AT LINE 452
                    > USED AT LINE 457
DOKEYPRE:           5009 DEFINED AT LINE 344
                    > USED AT LINE 432
                    > USED AT LINE 436
                    > USED AT LINE 440
DOSPEED:            500A DEFINED AT LINE 345
                    > USED AT LINE 413
                    > USED AT LINE 416
KEY_UP:             0007 DEFINED AT LINE 347
                    > USED AT LINE 442
KEY_DN:             0003 DEFINED AT LINE 348
                    > USED AT LINE 450
DODGY:              41D0 DEFINED AT LINE 349
                    > USED AT LINE 486
                    > USED AT LINE 1103
DO1:                41D6 DEFINED AT LINE 354
                    > USED AT LINE 357
DOGAME:             41DC DEFINED AT LINE 359
                    > USED AT LINE 434
DO2:                41E5 DEFINED AT LINE 365
                    > USED AT LINE 369
DO3:                41FB DEFINED AT LINE 377
                    > USED AT LINE 374
                    > USED AT LINE 382
DO4:                4205 DEFINED AT LINE 383
DO5:                420B DEFINED AT LINE 388
                    > USED AT LINE 376
DO6:                4233 DEFINED AT LINE 419
                    > USED AT LINE 362
DO9:                4244 DEFINED AT LINE 433
                    > USED AT LINE 438
                    > USED AT LINE 446
                    > USED AT LINE 451
                    > USED AT LINE 454
                    > USED AT LINE 458
DO10:               4246 DEFINED AT LINE 435
                    > USED AT LINE 430
DO11:               425E DEFINED AT LINE 449
                    > USED AT LINE 443
DO12:               426A DEFINED AT LINE 456
                    > USED AT LINE 448
DO13:               426F DEFINED AT LINE 461
                    > USED AT LINE 399
DO14:               4275 DEFINED AT LINE 464
                    > USED AT LINE 485
FS3:                4279 DEFINED AT LINE 468
                    > USED AT LINE 474
FS4:                427C DEFINED AT LINE 471
                    > USED AT LINE 471
OBSTACLES:          4294 DEFINED AT LINE 488
                    > USED AT LINE 384
DOPLAYER:           4297 DEFINED AT LINE 490
                    > USED AT LINE 392
DOSCAN:             429A DEFINED AT LINE 493
                    > USED AT LINE 420
                    > USED AT LINE 476
DO7:                429F DEFINED AT LINE 496
                    > USED AT LINE 508
DO8:                42A7 DEFINED AT LINE 502
                    > USED AT LINE 502
DOCON_HL:           42B5 DEFINED AT LINE 513
                    > USED AT LINE 463
DOCON_A:            42BD DEFINED AT LINE 518
                    > USED AT LINE 516
DOCON_NIBBLE:       42C6 DEFINED AT LINE 527
                    > USED AT LINE 524
SPIALIEN:           42D1 DEFINED AT LINE 539
                    > USED AT LINE 644
                    > USED AT LINE 1105
DELAYSP:            5000 DEFINED AT LINE 541
                    > USED AT LINE 549
                    > USED AT LINE 606
                    > USED AT LINE 610
                    > USED AT LINE 646
MESGADR:            5002 DEFINED AT LINE 542
                    > USED AT LINE 640
                    > USED AT LINE 669
                    > USED AT LINE 778
                    > USED AT LINE 879
DISP_BUFF:          5004 DEFINED AT LINE 543
                    > USED AT LINE 712
                    > USED AT LINE 727
                    > USED AT LINE 751
                    > USED AT LINE 782
                    > USED AT LINE 789
                    > USED AT LINE 822
                    > USED AT LINE 831
                    > USED AT LINE 885
                    > USED AT LINE 889
SPSTART:            42D4 DEFINED AT LINE 546
                    > USED AT LINE 630
SP2:                42EB DEFINED AT LINE 563
                    > USED AT LINE 585
SP3:                4305 DEFINED AT LINE 581
                    > USED AT LINE 578
SP4:                4310 DEFINED AT LINE 589
                    > USED AT LINE 580
SP5:                4313 DEFINED AT LINE 591
                    > USED AT LINE 588
SP6:                4315 DEFINED AT LINE 593
                    > USED AT LINE 623
SP7:                431B DEFINED AT LINE 598
                    > USED AT LINE 619
SP8:                432B DEFINED AT LINE 608
                    > USED AT LINE 609
SP9:                434B DEFINED AT LINE 629
                    > USED AT LINE 627
GAMEOVER:           434D DEFINED AT LINE 631
SP11:               435E DEFINED AT LINE 639
                    > USED AT LINE 636
DELAY:              436A DEFINED AT LINE 645
                    > USED AT LINE 566
                    > USED AT LINE 605
SP10:               4370 DEFINED AT LINE 649
                    > USED AT LINE 653
RANDOM:             4376 DEFINED AT LINE 656
                    > USED AT LINE 378
                    > USED AT LINE 551
                    > USED AT LINE 746
                    > USED AT LINE 943
ASCII_SCRL:         4385 DEFINED AT LINE 668
                    > USED AT LINE 643
                    > USED AT LINE 681
                    > USED AT LINE 779
                    > USED AT LINE 882
ASC0:               438B DEFINED AT LINE 671
                    > USED AT LINE 684
ASC1:               438D DEFINED AT LINE 673
                    > USED AT LINE 678
ALIENS:             43A0 DEFINED AT LINE 686
                    > USED AT LINE 557
AHTABLE:            43A4 DEFINED AT LINE 687
                    > USED AT LINE 590
AMTABLE:            43AA DEFINED AT LINE 688
                    > USED AT LINE 587
WINTUNE:            43B0 DEFINED AT LINE 689
                    > USED AT LINE 632
                    > USED AT LINE 1043
LOSTUNE:            43BA DEFINED AT LINE 690
                    > USED AT LINE 637
WINMESG:            43C4 DEFINED AT LINE 691
                    > USED AT LINE 633
LOSMESG:            43E2 DEFINED AT LINE 694
                    > USED AT LINE 638
NIMMATCH:           5000 DEFINED AT LINE 703
                    > USED AT LINE 708
                    > USED AT LINE 732
                    > USED AT LINE 760
                    > USED AT LINE 766
                    > USED AT LINE 790
NIMPLAYER:          5001 DEFINED AT LINE 704
                    > USED AT LINE 710
                    > USED AT LINE 719
                    > USED AT LINE 772
NIM:                43FD DEFINED AT LINE 706
                    > USED AT LINE 780
                    > USED AT LINE 1107
NM1:                440D DEFINED AT LINE 714
                    > USED AT LINE 717
NM2:                4411 DEFINED AT LINE 718
                    > USED AT LINE 767
NM3:                441F DEFINED AT LINE 726
                    > USED AT LINE 731
NM31:               4439 DEFINED AT LINE 741
                    > USED AT LINE 736
                    > USED AT LINE 738
NM4:                443E DEFINED AT LINE 745
                    > USED AT LINE 734
NM5:                4447 DEFINED AT LINE 750
                    > USED AT LINE 724
                    > USED AT LINE 753
                    > USED AT LINE 755
                    > USED AT LINE 757
NM6:                4454 DEFINED AT LINE 758
                    > USED AT LINE 740
                    > USED AT LINE 744
                    > USED AT LINE 749
NIMGAMEOVR:         4464 DEFINED AT LINE 768
                    > USED AT LINE 762
                    > USED AT LINE 763
                    > USED AT LINE 771
NM7:                4476 DEFINED AT LINE 777
                    > USED AT LINE 775
NIMSCREEN:          447F DEFINED AT LINE 781
                    > USED AT LINE 722
NM8:                4488 DEFINED AT LINE 786
                    > USED AT LINE 784
NIMWINNER:          4495 DEFINED AT LINE 796
                    > USED AT LINE 774
NIMLOSER:           44B3 DEFINED AT LINE 799
                    > USED AT LINE 776
LLALT:              5002 DEFINED AT LINE 809
                    > USED AT LINE 816
                    > USED AT LINE 861
                    > USED AT LINE 864
                    > USED AT LINE 890
LLVEL:              5001 DEFINED AT LINE 810
                    > USED AT LINE 820
                    > USED AT LINE 851
                    > USED AT LINE 854
                    > USED AT LINE 856
                    > USED AT LINE 859
LLFUEL:             5000 DEFINED AT LINE 811
                    > USED AT LINE 818
                    > USED AT LINE 845
                    > USED AT LINE 850
                    > USED AT LINE 886
PLUSKEY:            0010 DEFINED AT LINE 812
                    > USED AT LINE 836
LUNALANDER:         44D1 DEFINED AT LINE 814
                    > USED AT LINE 883
                    > USED AT LINE 1109
LL1:                44E4 DEFINED AT LINE 823
                    > USED AT LINE 826
LL2:                44E8 DEFINED AT LINE 827
                    > USED AT LINE 866
LL3:                44EE DEFINED AT LINE 830
                    > USED AT LINE 842
LL33:               44FA DEFINED AT LINE 838
                    > USED AT LINE 835
LL4:                4501 DEFINED AT LINE 844
                    > USED AT LINE 837
LL5:                4515 DEFINED AT LINE 855
                    > USED AT LINE 843
                    > USED AT LINE 847
LL6:                453B DEFINED AT LINE 875
                    > USED AT LINE 871
LL7:                4541 DEFINED AT LINE 878
                    > USED AT LINE 874
LLSCREEN:           454D DEFINED AT LINE 884
                    > USED AT LINE 828
LLS1:               456B DEFINED AT LINE 899
                    > USED AT LINE 894
                    > USED AT LINE 897
LUNAWIN:            4575 DEFINED AT LINE 910
                    > USED AT LINE 877
LUNALOSE:           457E DEFINED AT LINE 911
                    > USED AT LINE 873
LUNAWINNER:         4587 DEFINED AT LINE 912
                    > USED AT LINE 876
LUNALOSER:          45A8 DEFINED AT LINE 916
                    > USED AT LINE 872
MMGUESS:            5000 DEFINED AT LINE 920
                    > USED AT LINE 979
                    > USED AT LINE 1002
MMANSWER:           5004 DEFINED AT LINE 921
                    > USED AT LINE 951
                    > USED AT LINE 1001
MM_BUFF:            5008 DEFINED AT LINE 922
                    > USED AT LINE 925
                    > USED AT LINE 934
                    > USED AT LINE 941
                    > USED AT LINE 950
                    > USED AT LINE 968
                    > USED AT LINE 980
                    > USED AT LINE 983
                    > USED AT LINE 1035
                    > USED AT LINE 1047
                    > USED AT LINE 1057
                    > USED AT LINE 1074
MMSCORE:            500E DEFINED AT LINE 923
                    > USED AT LINE 967
                    > USED AT LINE 1008
                    > USED AT LINE 1010
                    > USED AT LINE 1022
                    > USED AT LINE 1024
                    > USED AT LINE 1036
                    > USED AT LINE 1040
                    > USED AT LINE 1050
MASTERMIND:         45C6 DEFINED AT LINE 924
                    > USED AT LINE 948
                    > USED AT LINE 1052
                    > USED AT LINE 1111
MM00:               45CC DEFINED AT LINE 928
                    > USED AT LINE 931
MM0:                45D2 DEFINED AT LINE 933
                    > USED AT LINE 939
MM1:                45E1 DEFINED AT LINE 942
                    > USED AT LINE 947
MM2:                45EB DEFINED AT LINE 949
                    > USED AT LINE 938
MM3:                45F3 DEFINED AT LINE 953
                    > USED AT LINE 963
MM4:                45F5 DEFINED AT LINE 955
                    > USED AT LINE 960
MM5:                4600 DEFINED AT LINE 965
                    > USED AT LINE 1053
MM6:                460A DEFINED AT LINE 971
                    > USED AT LINE 974
MM7:                461A DEFINED AT LINE 982
                    > USED AT LINE 985
                    > USED AT LINE 987
                    > USED AT LINE 997
MM8:                4635 DEFINED AT LINE 999
MM9:                4640 DEFINED AT LINE 1004
                    > USED AT LINE 1032
MM10:               464C DEFINED AT LINE 1011
                    > USED AT LINE 1007
MM11:               464F DEFINED AT LINE 1014
                    > USED AT LINE 1026
MM12:               465F DEFINED AT LINE 1025
                    > USED AT LINE 1021
MM13:               4681 DEFINED AT LINE 1046
                    > USED AT LINE 1042
                    > USED AT LINE 1049
THINKING:           4692 DEFINED AT LINE 1055
                    > USED AT LINE 1000
THK1:               4697 DEFINED AT LINE 1058
                    > USED AT LINE 1086
THK2:               469D DEFINED AT LINE 1062
                    > USED AT LINE 1084
THK3:               46A7 DEFINED AT LINE 1072
                    > USED AT LINE 1081
THINKTBL:           46BB DEFINED AT LINE 1089
                    > USED AT LINE 1059
GAMESMENUCFG:       46CB DEFINED AT LINE 1093
                    > USED AT LINE 21
ASCII_STR:          474A DEFINED AT LINE 1113
                    > USED AT LINE 670
                    > USED AT LINE 674
                    > USED AT LINE 682
RANDNO:             474C DEFINED AT LINE 1115
                    > USED AT LINE 20
                    > USED AT LINE 660
                    > USED AT LINE 664
